# Excersise 11: Creating a Basic Server with Terraform on Hetzner Cloud

### 1. Minimal Terraform Configuration

We started from a minimal Terraform configuration (based on Figure 1004) and defined a Hetzner Cloud server resource. The provider was initialized using the Hetzner API token.

**Steps:**

1. Created a new Terraform project.
2. Initialized the backend using:

```hlc
terraform init
```

Confirmation: `Terraform has been successfully initialized!`

3. Defined a `hcloud_server` resource (`exercise-11`) with:

- Debian 12 image
- cpx11 server type
- 40 GB disk
- Firewall configuration
- SSH key access.

### 2. Firewall Rule for SSH Access

An inbound firewall rule was added to allow SSH (port 22) connections.
This was necessary to establish secure remote access to the server.

### 3. Hetzner API Token

We entered the Hetzner Cloud API token to enable Terraform to authenticate with Hetzner.

**Note:** Since version control is required, storing the token directly in the configuration would be unsafe. Instead, we followed the solution from Figure 1018 by placing the token in a separate file (not committed to Git).

### 4. Server Creation and Initial Login

Running:

```hcl
terraform apply
```

Terraform created the server successfully:

```hcl
hcloud_server.exercise_11: Creation complete after 13s
```

Hetzner automatically sent an email with the serverâ€™s IP address and root password.
This happens because no SSH key was yet associated with the server at the time of its first creation. For security, Hetzner provides initial credentials via email.

We verified login via:

```hcl
ssh root@<server-ip>
```

### 5. Switching to Public/Private Key Authentication

To avoid insecure password-based login, we configured SSH key authentication.

**Steps:**

1. Created an hcloud_ssh_key resource with our public key.
2. Attached the SSH key to the server resource in Terraform.
3. Reapplied Terraform configuration.
4. Verified login with:

```hcl
ssh -i ~/.ssh/id_rsa root@<server-ip>
```

Now login works securely with our private key.

### 6. Outputs Configuration

To automatically display the server IP and datacenter, we added an outputs.tf file with:

```hcl
output "server_ip" {
  value = hcloud_server.exercise_11.ipv4_address
}

output "server_datacenter" {
  value = hcloud_server.exercise_11.datacenter
}
```

On success, the output looked like:

```hcl
Apply complete! Resources: 3 added, 0 changed, 0 destroyed.

Outputs:

server_datacenter = "hel1-dc2"
server_ip         = "95.216.223.223"
```

### 7. Version Control with Git

The Terraform configuration was placed under version control in a Git repository.
To avoid leaking secrets, the Hetzner API token was excluded by using `.gitignore` and a separate file approach.
