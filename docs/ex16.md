# Exercise 16: Mount Pointâ€™s Name Specification

## 1. Goal

The goal of this exercise was to replace the **auto-generated Cloud-init mount point** (e.g., `/mnt/HC_Volume_102626366`) with a **custom mount point** `/volume01`.
This required creating the server and volume independently, attaching the volume manually (`automount = false`), and configuring the mount via Cloud-init so that it persists after reboot.

## 2. Terraform Configuration

We extended the configuration from Exercise 15.

- **Server and volume created independently**
- Both placed in the same location (`hel1`)
- **Volume attached manually** with `automount = false`
- Passed the Linux device path and mount point name to Cloud-init

### Terraform Snippet

```hcl
resource "hcloud_volume" "volume01" {
  name     = "volume1-ex16"
  size     = 10
  location = "hel1"
  format   = "xfs"
}

resource "hcloud_volume_attachment" "volAttach" {
  volume_id = hcloud_volume.volume01.id
  server_id = hcloud_server.exercise_14.id
  automount = false
}

output "volume_linux_device" {
  description = "The volume's linux device"
  value       = hcloud_volume.volume01.linux_device
}
```

## 3. Cloud-init Configuration

We modified the Cloud-init template to:

- Create the mount point `/volume01`
- Append an entry to `/etc/fstab`using the - UUID of the volume
- Reload systemd to account for fstab changes
- Mount the volume immediately

### Cloud-init Snippet

```hcl
#cloud-config
runcmd:
  - mkdir -p /volume01
  - echo "UUID=a3de7773-6b5e-4f51-886a-bbccf85d0b32 /volume01 xfs defaults 0 0" >> /etc/fstab
  - systemctl daemon-reload
  - mount -a
```

## 4. Deployment and Verification

1. Applied the configuration:

```hcl
terraform apply
```

2. Verified that the new volume appeared:

```hcl
lsblk
```

Result showed `/dev/sdb` with 10 GB.

3. Mounted the volume manually for testing:

```tf
sudo mkdir -p /volume01
sudo mount /dev/disk/by-id/scsi-0HC_Volume_102995935 /volume01
```

4. Checked the UUID and updated /etc/fstab:

```tf
sudo blkid /dev/disk/by-id/scsi-0HC_Volume_102995935
```

5. Reloaded systemd and mounted all filesystems:

```tf
sudo systemctl daemon-reload
sudo mount -a
```

6. Verified with:

```tf
df -h
```

Output confirmed:

```tf
/dev/sdb   10G   104M  9.9G   2% /volume01
```

7. Tested write access:

```tf
echo "Test successful!" | sudo tee /volume01/test.txt
```
